{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "additionalProperties": true,
  "description": "Standard delivery metrics that can be reported at media buy, package, or creative level",
  "properties": {
    "by_action_source": {
      "description": "Conversion metrics broken down by action source (website, app, in_store, etc.). Useful for omnichannel sellers where conversions occur across digital and physical channels.",
      "items": {
        "additionalProperties": true,
        "properties": {
          "action_source": {
            "$ref": "../enums/action-source.json",
            "description": "Where the conversion occurred"
          },
          "count": {
            "description": "Number of conversions from this action source",
            "minimum": 0,
            "type": "number"
          },
          "event_source_id": {
            "description": "Event source that produced these conversions (for disambiguation when multiple event sources are configured)",
            "type": "string"
          },
          "value": {
            "description": "Total monetary value of conversions from this action source",
            "minimum": 0,
            "type": "number"
          }
        },
        "required": [
          "action_source",
          "count"
        ],
        "type": "object"
      },
      "type": "array"
    },
    "by_event_type": {
      "description": "Conversion metrics broken down by event type. Spend-derived metrics (ROAS, CPA) are only available at the package/totals level since spend cannot be attributed to individual event types.",
      "items": {
        "additionalProperties": true,
        "properties": {
          "count": {
            "description": "Number of events of this type",
            "minimum": 0,
            "type": "number"
          },
          "event_source_id": {
            "description": "Event source that produced these conversions (for disambiguation when multiple event sources are configured)",
            "type": "string"
          },
          "event_type": {
            "$ref": "../enums/event-type.json",
            "description": "The event type"
          },
          "value": {
            "description": "Total monetary value of events of this type",
            "minimum": 0,
            "type": "number"
          }
        },
        "required": [
          "event_type",
          "count"
        ],
        "type": "object"
      },
      "type": "array"
    },
    "clicks": {
      "description": "Total clicks",
      "minimum": 0,
      "type": "number"
    },
    "completed_views": {
      "description": "100% completions (for CPCV)",
      "minimum": 0,
      "type": "number"
    },
    "completion_rate": {
      "description": "Completion rate (completed_views/impressions)",
      "maximum": 1,
      "minimum": 0,
      "type": "number"
    },
    "conversion_value": {
      "description": "Total monetary value of attributed conversions (in the reporting currency)",
      "minimum": 0,
      "type": "number"
    },
    "conversions": {
      "description": "Total conversions attributed to this delivery. When by_event_type is present, this equals the sum of all by_event_type[].count entries.",
      "minimum": 0,
      "type": "number"
    },
    "cost_per_acquisition": {
      "description": "Cost per conversion (spend / conversions)",
      "minimum": 0,
      "type": "number"
    },
    "cost_per_click": {
      "description": "Cost per click (spend / clicks)",
      "minimum": 0,
      "type": "number"
    },
    "ctr": {
      "description": "Click-through rate (clicks/impressions)",
      "maximum": 1,
      "minimum": 0,
      "type": "number"
    },
    "dooh_metrics": {
      "additionalProperties": true,
      "description": "DOOH-specific metrics (only included for DOOH campaigns)",
      "properties": {
        "calculation_notes": {
          "description": "Explanation of how DOOH impressions were calculated",
          "type": "string"
        },
        "loop_plays": {
          "description": "Number of times ad played in rotation",
          "minimum": 0,
          "type": "integer"
        },
        "screen_time_seconds": {
          "description": "Total display time in seconds",
          "minimum": 0,
          "type": "integer"
        },
        "screens_used": {
          "description": "Number of unique screens displaying the ad",
          "minimum": 0,
          "type": "integer"
        },
        "sov_achieved": {
          "description": "Actual share of voice delivered (0.0 to 1.0)",
          "maximum": 1,
          "minimum": 0,
          "type": "number"
        },
        "venue_breakdown": {
          "description": "Per-venue performance breakdown",
          "items": {
            "additionalProperties": true,
            "properties": {
              "impressions": {
                "description": "Impressions delivered at this venue",
                "minimum": 0,
                "type": "integer"
              },
              "loop_plays": {
                "description": "Loop plays at this venue",
                "minimum": 0,
                "type": "integer"
              },
              "screens_used": {
                "description": "Number of screens used at this venue",
                "minimum": 0,
                "type": "integer"
              },
              "venue_id": {
                "description": "Venue identifier",
                "type": "string"
              },
              "venue_name": {
                "description": "Human-readable venue name",
                "type": "string"
              },
              "venue_type": {
                "description": "Venue type (e.g., 'airport', 'transit', 'retail', 'billboard')",
                "type": "string"
              }
            },
            "required": [
              "venue_id",
              "impressions"
            ],
            "type": "object"
          },
          "type": "array"
        }
      },
      "type": "object"
    },
    "engagement_rate": {
      "description": "Platform-specific engagement rate (0.0 to 1.0). Definition varies by platform (e.g., likes+comments+shares/impressions on social, interactions/impressions on rich media).",
      "maximum": 1,
      "minimum": 0,
      "type": "number"
    },
    "frequency": {
      "description": "Average frequency per individual (typically measured over campaign duration, but can vary by measurement provider)",
      "minimum": 0,
      "type": "number"
    },
    "grps": {
      "description": "Gross Rating Points delivered (for CPP)",
      "minimum": 0,
      "type": "number"
    },
    "impressions": {
      "description": "Impressions delivered",
      "minimum": 0,
      "type": "number"
    },
    "leads": {
      "description": "Leads generated (convenience alias for by_event_type where event_type='lead')",
      "minimum": 0,
      "type": "number"
    },
    "new_to_brand_rate": {
      "description": "Fraction of conversions from first-time brand buyers (0 = none, 1 = all)",
      "maximum": 1,
      "minimum": 0,
      "type": "number"
    },
    "quartile_data": {
      "description": "Video quartile completion data",
      "properties": {
        "q1_views": {
          "description": "25% completion views",
          "minimum": 0,
          "type": "number"
        },
        "q2_views": {
          "description": "50% completion views",
          "minimum": 0,
          "type": "number"
        },
        "q3_views": {
          "description": "75% completion views",
          "minimum": 0,
          "type": "number"
        },
        "q4_views": {
          "description": "100% completion views",
          "minimum": 0,
          "type": "number"
        }
      },
      "type": "object"
    },
    "reach": {
      "description": "Unique reach - units depend on measurement provider (e.g., individuals, households, devices, cookies). See delivery_measurement.provider for methodology.",
      "minimum": 0,
      "type": "number"
    },
    "roas": {
      "description": "Return on ad spend (conversion_value / spend)",
      "minimum": 0,
      "type": "number"
    },
    "spend": {
      "description": "Amount spent",
      "minimum": 0,
      "type": "number"
    },
    "viewability": {
      "additionalProperties": true,
      "description": "Viewability metrics. Viewable rate should be calculated as viewable_impressions / measurable_impressions (not total impressions), since some environments cannot measure viewability.",
      "properties": {
        "measurable_impressions": {
          "description": "Impressions where viewability could be measured. Excludes environments without measurement capability (e.g., non-Intersection Observer browsers, certain app environments).",
          "minimum": 0,
          "type": "number"
        },
        "standard": {
          "description": "Viewability measurement standard. 'mrc': 50% of pixels in view for 1 second (display) or 2 seconds (video), per MRC/IAB guidelines. 'groupm': 100% of pixels in view for the same durations. These are materially different thresholds and should not be compared across standards.",
          "enum": [
            "mrc",
            "groupm"
          ],
          "type": "string"
        },
        "viewable_impressions": {
          "description": "Impressions that met the viewability threshold defined by the measurement standard.",
          "minimum": 0,
          "type": "number"
        },
        "viewable_rate": {
          "description": "Viewable impression rate (viewable_impressions / measurable_impressions). Range 0.0 to 1.0.",
          "maximum": 1,
          "minimum": 0,
          "type": "number"
        }
      },
      "type": "object"
    },
    "views": {
      "description": "Views at threshold (for CPV)",
      "minimum": 0,
      "type": "number"
    }
  },
  "title": "Delivery Metrics",
  "type": "object"
}